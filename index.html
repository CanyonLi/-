<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æƒ…ä¾£ä»»åŠ¡ç®¡ç†å™¨ - é«˜çº§ç‰ˆ</title>
  <!-- å¼•å…¥ TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¼•å…¥ GSAP åŠ¨ç”»åº“ CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
  <!-- å¼•å…¥ Vue3 å…¨å±€æ„å»ºç‰ˆæœ¬ CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body class="min-h-screen bg-gray-50">
  <div id="app" class="max-w-5xl w-full mx-auto p-4 md:p-6">
    <!-- å…¨å±€æ—¥æœŸé€‰æ‹©å™¨ï¼šåˆ‡æ¢æŸ¥çœ‹ä¸åŒæ—¥æœŸçš„ä»»åŠ¡ï¼ˆå†å²æµè§ˆï¼‰ -->
    <div class="mb-4 flex flex-col items-center">
      <label class="mb-2 text-lg font-semibold text-gray-700">å½“å‰æŸ¥çœ‹æ—¥æœŸï¼š</label>
      <input type="date" v-model="selectedDate" class="p-2 border rounded" />
    </div>
    <!-- å“åº”å¼å·¦å³åˆ†æ  -->
    <div class="flex flex-col md:flex-row gap-4">
      <!-- å·¦ä¾§ï¼šğŸ¶ğŸŒ­ ä»»åŠ¡åŒºï¼ˆè“è‰²ä¸»é¢˜ï¼‰ -->
      <div ref="dogColumn" class="flex-1 md:w-1/2 bg-blue-50 rounded-lg p-4 relative">
        <h2 class="text-xl font-bold text-blue-700 flex items-center mb-3">ğŸ¶ğŸŒ­ çš„ä»»åŠ¡</h2>
        <!-- ä»»åŠ¡åˆ—è¡¨ -->
        <ul>
          <li v-for="(task, index) in filteredTasks('dog')" :key="task.id" class="mb-2 p-2 rounded flex items-start bg-white shadow">
            <input type="checkbox" v-model="task.completed" @change="completeTask('dog', index)" class="mt-1 mr-2 accent-blue-500" />
            <div class="flex-1">
              <div class="flex justify-between items-center">
                <span class="font-medium" :class="{ 'line-through text-gray-400': task.completed }">{{ task.title }}</span>
                <span v-if="task.priority" class="text-xs font-semibold px-2 py-1 rounded ml-2"
                      :class="{
                        'bg-red-200 text-red-800': task.priority === 'é«˜',
                        'bg-yellow-200 text-yellow-800': task.priority === 'ä¸­',
                        'bg-green-200 text-green-800': task.priority === 'ä½'
                      }">
                  {{ task.priority }}ä¼˜å…ˆ
                </span>
              </div>
              <p class="text-sm text-gray-500">æ—¥æœŸ: {{ task.date }} {{ task.plannedTime ? '| è®¡åˆ’å®Œæˆ: ' + task.plannedTime : '' }}</p>
              <p v-if="task.note" class="text-gray-600 text-sm mt-1">å¤‡æ³¨: {{ task.note }}</p>
            </div>
          </li>
        </ul>
        <!-- æ–°å¢ä»»åŠ¡è¡¨å• -->
        <div class="mt-4 border-t pt-4">
          <h3 class="text-lg font-semibold text-blue-700 mb-2">æ–°å¢ä»»åŠ¡</h3>
          <form @submit.prevent="addTask('dog')">
            <div class="mb-2">
              <input v-model="newTask.dog.title" type="text" placeholder="ä»»åŠ¡åç§°" class="w-full p-2 border rounded" required />
            </div>
            <div class="mb-2 flex gap-2">
              <input v-model="newTask.dog.date" type="date" class="w-1/2 p-2 border rounded" required />
              <input v-model="newTask.dog.plannedTime" type="time" class="w-1/2 p-2 border rounded" placeholder="å®Œæˆæ—¶é—´" />
            </div>
            <div class="mb-2">
              <select v-model="newTask.dog.priority" class="w-full p-2 border rounded">
                <option value="">é€‰æ‹©ä¼˜å…ˆçº§</option>
                <option value="é«˜">é«˜</option>
                <option value="ä¸­">ä¸­</option>
                <option value="ä½">ä½</option>
              </select>
            </div>
            <div class="mb-2">
              <textarea v-model="newTask.dog.note" placeholder="å¤‡æ³¨" class="w-full p-2 border rounded"></textarea>
            </div>
            <button type="submit" class="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600">æ·»åŠ ä»»åŠ¡</button>
          </form>
        </div>
        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="mt-6 text-center">
          <div class="text-sm text-gray-700">å®Œæˆç‡: {{ completionRate('dog') }}%</div>
        </div>
      </div>
      <!-- å³ä¾§ï¼šğŸ±ğŸ£ ä»»åŠ¡åŒºï¼ˆç²‰è‰²ä¸»é¢˜ï¼‰ -->
      <div ref="catColumn" class="flex-1 md:w-1/2 bg-pink-50 rounded-lg p-4 relative">
        <h2 class="text-xl font-bold text-pink-700 flex items-center mb-3">ğŸ±ğŸ£ çš„ä»»åŠ¡</h2>
        <ul>
          <li v-for="(task, index) in filteredTasks('cat')" :key="task.id" class="mb-2 p-2 rounded flex items-start bg-white shadow">
            <input type="checkbox" v-model="task.completed" @change="completeTask('cat', index)" class="mt-1 mr-2 accent-pink-500" />
            <div class="flex-1">
              <div class="flex justify-between items-center">
                <span class="font-medium" :class="{ 'line-through text-gray-400': task.completed }">{{ task.title }}</span>
                <span v-if="task.priority" class="text-xs font-semibold px-2 py-1 rounded ml-2"
                      :class="{
                        'bg-red-200 text-red-800': task.priority === 'é«˜',
                        'bg-yellow-200 text-yellow-800': task.priority === 'ä¸­',
                        'bg-green-200 text-green-800': task.priority === 'ä½'
                      }">
                  {{ task.priority }}ä¼˜å…ˆ
                </span>
              </div>
              <p class="text-sm text-gray-500">æ—¥æœŸ: {{ task.date }} {{ task.plannedTime ? '| è®¡åˆ’å®Œæˆ: ' + task.plannedTime : '' }}</p>
              <p v-if="task.note" class="text-gray-600 text-sm mt-1">å¤‡æ³¨: {{ task.note }}</p>
            </div>
          </li>
        </ul>
        <div class="mt-4 border-t pt-4">
          <h3 class="text-lg font-semibold text-pink-700 mb-2">æ–°å¢ä»»åŠ¡</h3>
          <form @submit.prevent="addTask('cat')">
            <div class="mb-2">
              <input v-model="newTask.cat.title" type="text" placeholder="ä»»åŠ¡åç§°" class="w-full p-2 border rounded" required />
            </div>
            <div class="mb-2 flex gap-2">
              <input v-model="newTask.cat.date" type="date" class="w-1/2 p-2 border rounded" required />
              <input v-model="newTask.cat.plannedTime" type="time" class="w-1/2 p-2 border rounded" placeholder="å®Œæˆæ—¶é—´" />
            </div>
            <div class="mb-2">
              <select v-model="newTask.cat.priority" class="w-full p-2 border rounded">
                <option value="">é€‰æ‹©ä¼˜å…ˆçº§</option>
                <option value="é«˜">é«˜</option>
                <option value="ä¸­">ä¸­</option>
                <option value="ä½">ä½</option>
              </select>
            </div>
            <div class="mb-2">
              <textarea v-model="newTask.cat.note" placeholder="å¤‡æ³¨" class="w-full p-2 border rounded"></textarea>
            </div>
            <button type="submit" class="w-full bg-pink-500 text-white p-2 rounded hover:bg-pink-600">æ·»åŠ ä»»åŠ¡</button>
          </form>
        </div>
        <div class="mt-6 text-center">
          <div class="text-sm text-gray-700">å®Œæˆç‡: {{ completionRate('cat') }}%</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Vue åº”ç”¨é€»è¾‘ -->
  <script>
    const { createApp } = Vue;
    createApp({
      data() {
        return {
          // å½“å‰å…¨å±€é€‰ä¸­çš„æ—¥æœŸï¼ˆç”¨äºå†å²æµè§ˆï¼‰ï¼Œé»˜è®¤ä»Šå¤©
          selectedDate: new Date().toISOString().split('T')[0],
          // å­˜å‚¨ä»»åŠ¡ï¼Œåˆ†åˆ«ä¸º dog å’Œ cat ä¸¤ä¾§
          tasks: {
            dog: [
              // ç¤ºä¾‹æ•°æ®ï¼ˆåç»­æ•°æ®å¯ä» localStorage æˆ–æ•°æ®åº“åŠ è½½ï¼‰
              { id: 1, title: 'æ•£æ­¥', date: '2025-03-11', plannedTime: '19:00', priority: 'ä¸­', note: 'æ™šä¸Šä¸€èµ·æ•£æ­¥', completed: false },
              { id: 2, title: 'æ™šé¤çº¦ä¼š', date: '2025-03-11', plannedTime: '20:00', priority: 'é«˜', note: 'é¢„çº¦æ—¥æ–™', completed: false }
            ],
            cat: [
              { id: 3, title: 'è´­ä¹°ç¤¼ç‰©', date: '2025-03-11', plannedTime: '18:30', priority: 'é«˜', note: 'ç»™å¯¹æ–¹ä¸€ä¸ªæƒŠå–œ', completed: false },
              { id: 4, title: 'æ•´ç†æˆ¿é—´', date: '2025-03-10', plannedTime: '16:00', priority: 'ä½', note: '', completed: false }
            ]
          },
          // æ–°ä»»åŠ¡è¡¨å•æ•°æ®ï¼ˆæ¯ä¾§ç‹¬ç«‹ï¼‰ï¼Œé»˜è®¤æ—¥æœŸä¸ºå½“å‰é€‰ä¸­çš„æ—¥æœŸ
          newTask: {
            dog: { title: '', date: new Date().toISOString().split('T')[0], plannedTime: '', priority: '', note: '' },
            cat: { title: '', date: new Date().toISOString().split('T')[0], plannedTime: '', priority: '', note: '' }
          }
        };
      },
      methods: {
        // æ ¹æ®é€‰ä¸­æ—¥æœŸå’Œä»»åŠ¡æ—¥æœŸè¿‡æ»¤ä»»åŠ¡ï¼š
        // æ˜¾ç¤ºå½“å¤©ä»»åŠ¡ä»¥åŠä¹‹å‰æœªå®Œæˆçš„ä»»åŠ¡
        filteredTasks(side) {
          return this.tasks[side].filter(task => {
            // å¦‚æœä»»åŠ¡æ—¥æœŸç­‰äºé€‰ä¸­æ—¥æœŸï¼Œæ˜¾ç¤º
            if (task.date === this.selectedDate) return true;
            // å¦‚æœä»»åŠ¡æ—¥æœŸå°äºé€‰ä¸­æ—¥æœŸä¸”æœªå®Œæˆï¼Œä¹Ÿæ˜¾ç¤ºï¼ˆè‡ªåŠ¨ä¿ç•™å‰ä¸€å¤©åŠæ›´æ—©çš„é—ç•™ä»»åŠ¡ï¼‰
            if (task.date < this.selectedDate && !task.completed) return true;
            return false;
          });
        },
        // æ·»åŠ ä»»åŠ¡ï¼šå°†æ–°ä»»åŠ¡åŠ å…¥å¯¹åº”ä¾§ä»»åŠ¡åˆ—è¡¨ï¼Œå¹¶é‡ç½®è¾“å…¥
        addTask(side) {
          const nt = this.newTask[side];
          if (!nt.title.trim() || !nt.date) return;
          const newTaskItem = {
            id: Date.now(),
            title: nt.title,
            date: nt.date,
            plannedTime: nt.plannedTime,
            priority: nt.priority,
            note: nt.note,
            completed: false
          };
          this.tasks[side].push(newTaskItem);
          // æ¸…ç©ºè¡¨å•ï¼ŒåŒæ—¶é»˜è®¤æ—¥æœŸé‡ç½®ä¸ºå½“å‰é€‰ä¸­æ—¥æœŸ
          this.newTask[side] = { title: '', date: this.selectedDate, plannedTime: '', priority: '', note: '' };
          // è¿™é‡Œå¯ä»¥è°ƒç”¨ä¿å­˜åˆ° localStorage æˆ–æ•°æ®åº“çš„å‡½æ•°
        },
        // å®Œæˆä»»åŠ¡æ—¶è§¦å‘ï¼šå¦‚æœä»»åŠ¡å‹¾é€‰ä¸ºå®Œæˆï¼Œåˆ™æ’­æ”¾åŠ¨ç”»
        completeTask(side, index) {
          const task = this.tasks[side][index];
          if (task.completed) {
            this.triggerCompletionAnimation(side);
          }
          // è¿™é‡Œå¯ä»¥æ›´æ–°ä»»åŠ¡åˆ° localStorage æˆ–æ•°æ®åº“
        },
        // ä½¿ç”¨ GSAP è§¦å‘å®Œæˆä»»åŠ¡æ—¶çš„åŠ¨ç”»æ•ˆæœ
        triggerCompletionAnimation(side) {
          const emojiChar = side === 'dog' ? 'ğŸ¶' : 'ğŸ±';
          const emojiEl = document.createElement('div');
          emojiEl.textContent = emojiChar;
          emojiEl.style.position = 'absolute';
          emojiEl.style.bottom = '20px';
          emojiEl.style.right = '20px';
          emojiEl.style.fontSize = '2rem';
          emojiEl.style.opacity = '0';
          const container = side === 'dog' ? this.$refs.dogColumn : this.$refs.catColumn;
          container.appendChild(emojiEl);
          gsap.to(emojiEl, {
            y: -80,
            opacity: 1,
            duration: 0.5,
            yoyo: true,
            repeat: 1,
            onComplete: () => {
              container.removeChild(emojiEl);
            }
          });
        },
        // è®¡ç®—å®Œæˆç‡ï¼šå·²å®Œæˆä»»åŠ¡å æ¯”
        completionRate(side) {
          const list = this.tasks[side];
          if (!list.length) return 0;
          const doneCount = list.filter(t => t.completed).length;
          return Math.round((doneCount / list.length) * 100);
        }
      },
      // mounted é’©å­ä¸­å¯åŠ å…¥ localStorage æ•°æ®åŠ è½½é€»è¾‘ï¼Œç¡®ä¿å†å²æ•°æ®ä¸ä¸¢å¤±
      mounted() {
        // ç¤ºä¾‹ï¼šåŠ è½½ localStorage ä¸­ä¿å­˜çš„ä»»åŠ¡ï¼ˆè‹¥å­˜åœ¨ï¼‰
        const savedTasks = localStorage.getItem('tasks');
        if (savedTasks) {
          try {
            this.tasks = JSON.parse(savedTasks);
          } catch (e) {
            console.error('ä»»åŠ¡æ•°æ®è§£æé”™è¯¯', e);
          }
        }
      },
      watch: {
        // æ¯æ¬¡ä»»åŠ¡æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨ä¿å­˜åˆ° localStorage
        tasks: {
          handler(newVal) {
            localStorage.setItem('tasks', JSON.stringify(newVal));
          },
          deep: true
        }
      }
    }).mount('#app');
  </script>
</body>
</html>
